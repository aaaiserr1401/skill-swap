{% extends 'base.html' %}
{% block title %}Админ-панель · SkillSwap{% endblock %}
{% block content %}
<div class="container" style="max-width:1200px;">
  <h1 class="text-2xl font-bold mb-4">Админ-панель</h1>
  
  <!-- Статистика -->
  <div class="grid-3" style="margin-bottom:2rem;">
    <div class="card">
      <h3 class="text-lg font-semibold mb-2">Пользователи</h3>
      <p class="text-3xl font-bold text-primary">{{ total_users }}</p>
      <p class="muted text-sm">Активных: {{ active_users }}</p>
      <p class="muted text-sm">Сегодня: {{ new_users_today }}, За неделю: {{ new_users_week }}</p>
    </div>
    
    <div class="card">
      <h3 class="text-lg font-semibold mb-2">Навыки</h3>
      <p class="text-3xl font-bold text-primary">{{ total_skills }}</p>
    </div>
    
    <div class="card">
      <h3 class="text-lg font-semibold mb-2">Обмены</h3>
      <p class="text-3xl font-bold text-primary">{{ total_exchanges }}</p>
      <p class="muted text-sm">Ожидают: {{ pending_exchanges }}</p>
      <p class="muted text-sm">Завершено: {{ completed_exchanges }}</p>
    </div>
  </div>
  
  <!-- Популярные навыки -->
  <div class="card" style="margin-bottom:2rem;">
    <h2 class="text-xl font-semibold mb-4">Популярные навыки</h2>
    <div class="grid-3">
      {% for skill in popular_skills %}
        <div class="card">
          <h3 class="font-semibold">{{ skill.name }}</h3>
          <p class="muted text-sm">Преподают: {{ skill.teachers_count }}</p>
          <p class="muted text-sm">Изучают: {{ skill.learners_count }}</p>
        </div>
      {% endfor %}
    </div>
  </div>
  
  <!-- Последние обмены -->
  <div class="card">
    <h2 class="text-xl font-semibold mb-4">Последние обмены</h2>
    <div style="overflow-x:auto;">
      <table style="width:100%; border-collapse:collapse;">
        <thead>
          <tr style="border-bottom:1px solid var(--outline);">
            <th style="padding:0.5rem; text-align:left;">Отправитель</th>
            <th style="padding:0.5rem; text-align:left;">Получатель</th>
            <th style="padding:0.5rem; text-align:left;">Навык</th>
            <th style="padding:0.5rem; text-align:left;">Статус</th>
            <th style="padding:0.5rem; text-align:left;">Дата</th>
          </tr>
        </thead>
        <tbody>
          {% for ex in recent_exchanges %}
            <tr style="border-bottom:1px solid var(--outline);">
              <td style="padding:0.5rem;">{{ ex.sender.username }}</td>
              <td style="padding:0.5rem;">{{ ex.receiver.username }}</td>
              <td style="padding:0.5rem;">{{ ex.skill.name }}</td>
              <td style="padding:0.5rem;">
                <span class="badge {% if ex.status == 'completed' %}badge-success{% elif ex.status == 'pending' %}badge-warn{% else %}badge-danger{% endif %}">
                  {{ ex.get_status_display }}
                </span>
              </td>
              <td style="padding:0.5rem;">{{ ex.created_at|date:"d.m.Y H:i" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  
  <!-- Навигация -->
  <div class="card" style="margin-top:2rem;">
    <div class="form-actions">
      <a href="{% url 'accounts:admin_users' %}" class="btn btn-primary">Управление пользователями</a>
      <a href="{% url 'accounts:admin_skills' %}" class="btn btn-primary">Управление навыками</a>
      <a href="{% url 'accounts:admin_exchanges' %}" class="btn btn-primary">Управление обменами</a>
    </div>
  </div>
</div>
{% endblock %}

